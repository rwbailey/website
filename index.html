<html>
    <head>
        <meta charset="utf-8">
        <script src="wasm_exec.js"></script>
        <script>
            const go = new Go();
            WebAssembly.instantiateStreaming(fetch("json.wasm"), go.importObject).then((result) => {
                go.run (result.instance);
            });
        </script>
        <body>
            <input type="file" onchange="encodeImageFileAsURL(this)">
            <input type="hidden" name="imageBase64" id="imageBase64">
            <input id="button" type="submit" name="button" value="Do image thing" onclick="iThing(imageBase64.value)">
       
            <img src="" id="theThing" name="theThing">
        </body>
        <script>
            var json = function(input) {
                jsonoutput.value = formatJSON(input)
            }
            var iThing = function(input) {
                theThing.src = imageThing(input)
            }
        </script>
    </head>

<script>
    function encodeImageFileAsURL(element) {
        var file = element.files[0];
        var reader = new FileReader();
        reader.onloadend = function() {
            // console.log('RESULT', reader.result)
            imageBase64.value = reader.result
        }
        reader.readAsDataURL(file);
    }
</script>

</html>